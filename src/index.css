@import "tailwindcss";

@source "../src";

@layer base {
  :root {
    --radius: 0.5rem;
    --sidebar-background: 0 0% 98%;
    --sidebar-foreground: 240 5.3% 26.1%;
    --sidebar-primary: 240 5.9% 10%;
    --sidebar-primary-foreground: 0 0% 98%;
    --sidebar-accent: 240 4.8% 95.9%;
    --sidebar-accent-foreground: 240 5.9% 10%;
    --sidebar-border: 220 13% 91%;
    --sidebar-ring: 217.2 91.2% 59.8%
  }
  .dark {
    --sidebar-background: 240 5.9% 10%;
    --sidebar-foreground: 240 4.8% 95.9%;
    --sidebar-primary: 224.3 76.3% 48%;
    --sidebar-primary-foreground: 0 0% 100%;
    --sidebar-accent: 240 3.7% 15.9%;
    --sidebar-accent-foreground: 240 4.8% 95.9%;
    --sidebar-border: 240 3.7% 15.9%;
    --sidebar-ring: 217.2 91.2% 59.8%
  }
  
  /* 强制设置基础样式，防止被 Telegram 主题覆盖 */
  html {
    background-color: #f9fafb !important;
    min-height: 100vh;
  }
  
  body {
    background-color: #f9fafb !important;
    margin: 0;
    padding: 0;
    min-height: 100vh;
    font-family: "Noto Sans SC", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }
  
  #root {
    background-color: #f9fafb !important;
    min-height: 100vh;
  }

  /* 确保 Telegram WebApp 容器也有正确的背景 */
  .tg-viewport {
    background-color: #f9fafb !important;
  }
}

/*
 * ⚠️ 关键修复：覆盖 Tailwind v4 preflight 的 img { height: auto }
 *
 * Tailwind v4 在 @layer base 中设置了 img { max-width: 100%; height: auto }。
 * 在标准浏览器中，@layer utilities 中的 .h-full { height: 100% } 和
 * .object-cover { object-fit: cover } 可以正确覆盖 base 层的规则。
 *
 * 但在 Telegram WebView（部分旧版 Chromium 内核）中，CSS @layer 可能不被
 * 完全支持，导致 height: auto 无法被 .h-full 覆盖，图片按原始尺寸显示。
 *
 * 解决方案：在 unlayered 区域（最高优先级）添加修复规则。
 * 使用 .object-cover 选择器确保只影响需要裁剪的图片。
 * 使用 .h-full、.w-full 选择器确保尺寸类正确生效。
 */
img.object-cover,
img.h-full,
img.w-full {
  max-width: none;
}

img.object-cover {
  object-fit: cover;
  object-position: center;
}

img.h-full {
  height: 100%;
}

img.w-full {
  width: 100%;
}

/* Loading spinner animation */
@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}
