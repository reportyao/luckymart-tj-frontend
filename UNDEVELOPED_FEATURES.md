# 未开发功能清单

本文档列出了TezBarakat管理后台中尚未实现的功能模块和特性。

## 1. KYC审核功能

**优先级**: 中

**描述**: 用户实名认证审核功能，用于验证用户身份信息。

**需要实现的功能**:
- KYC申请列表页面，显示所有待审核的实名认证申请
- KYC详情查看，包括用户上传的身份证件照片、个人信息等
- 审核操作，支持通过或拒绝认证申请
- 审核备注功能，记录审核意见
- 审核历史记录查询

**技术要点**:
- 需要在数据库中创建 `kyc_requests` 表
- 需要实现图片查看功能（身份证正反面照片）
- 需要添加敏感信息脱敏显示
- 需要实现审核通知功能

**建议实现步骤**:
1. 在Supabase中创建KYC申请表
2. 在server/routers.ts中添加KYC相关API
3. 创建KYCReview.tsx页面组件
4. 在App.tsx中添加路由
5. 在侧边栏菜单中添加入口

---

## 2. 开奖管理功能

**优先级**: 高

**描述**: 夺宝商品的开奖功能，用于确定中奖用户并发放奖品。

**需要实现的功能**:
- 开奖触发界面，支持手动开奖或定时自动开奖
- 开奖算法实现，确保公平性和随机性
- 中奖结果展示，显示中奖用户和中奖码
- 开奖记录查询，查看历史开奖数据
- 中奖通知发送，通过Telegram通知中奖用户
- 奖品发放状态跟踪

**技术要点**:
- 需要实现随机抽奖算法（可考虑使用区块链哈希或其他可验证的随机数生成方式）
- 需要集成Telegram Bot API发送通知
- 需要更新lottery表的状态为COMPLETED
- 需要在prizes表中创建中奖记录
- 需要处理并发开奖的情况（防止重复开奖）

**建议实现步骤**:
1. 在Lotteries页面或LotteryForm页面添加"开奖"按钮
2. 在server/routers.ts中实现开奖逻辑API
3. 实现随机抽奖算法
4. 创建开奖结果展示对话框
5. 集成Telegram通知功能
6. 添加开奖历史记录查询

---

## 3. 系统设置模块

**优先级**: 低

**描述**: 平台的全局配置管理，包括各种系统参数设置。

### 3.1 平台配置管理

**需要实现的功能**:
- 平台基本信息设置（名称、Logo、联系方式等）
- 业务规则配置（最小充值金额、最小提现金额、提现手续费率等）
- 功能开关管理（是否允许转售、是否需要KYC等）
- 时区和语言设置

### 3.2 佣金比例设置

**需要实现的功能**:
- 平台佣金比例配置（从每笔交易中抽取的百分比）
- 推荐奖励比例设置（邀请新用户的奖励比例）
- 不同商品类别的佣金差异化设置
- 佣金历史记录查询

### 3.3 通知模板管理

**需要实现的功能**:
- 各类通知模板的创建和编辑（中奖通知、充值成功通知、提现通知等）
- 模板变量管理（如 {{username}}, {{amount}} 等占位符）
- 多语言模板支持
- 通知渠道配置（Telegram、邮件、站内信等）
- 模板预览和测试发送

**技术要点**:
- 需要创建 `system_configs` 表存储配置项
- 需要创建 `notification_templates` 表存储通知模板
- 需要实现配置缓存机制，避免频繁查询数据库
- 需要实现模板渲染引擎（替换变量）

**建议实现步骤**:
1. 设计系统配置表结构
2. 创建SystemSettings.tsx页面
3. 实现配置项的增删改查API
4. 创建通知模板编辑器
5. 实现模板变量替换逻辑
6. 在侧边栏添加"系统设置"菜单项

---

## 4. 其他建议增强功能

以下是一些可以进一步提升管理后台体验的功能建议：

### 4.1 数据导出功能

为各个列表页面添加Excel导出功能，方便管理员进行数据分析和备份。

**实现要点**:
- 使用 `xlsx` 或 `exceljs` 库生成Excel文件
- 支持导出当前筛选条件下的数据
- 支持自定义导出字段
- 添加导出进度提示

### 4.2 操作日志记录

记录管理员的关键操作，便于审计和问题追溯。

**实现要点**:
- 创建 `admin_logs` 表
- 记录操作类型、操作对象、操作前后的值、操作时间、操作人等信息
- 提供日志查询和筛选界面
- 支持按时间范围、操作类型、操作人筛选

### 4.3 批量操作功能

为用户管理、商品管理等模块添加批量操作功能。

**实现要点**:
- 表格行选择功能
- 批量修改状态
- 批量删除（软删除）
- 批量导出

### 4.4 数据可视化增强

在仪表板中添加更多图表，展示业务数据趋势。

**实现要点**:
- 使用 `recharts` 或 `chart.js` 库
- 添加用户增长趋势图（折线图）
- 添加销售额统计图（柱状图）
- 添加商品销售排行榜
- 添加时间范围筛选器

### 4.5 实时通知功能

使用WebSocket或Server-Sent Events实现实时通知。

**实现要点**:
- 当有新的充值申请、提现申请、晒单等待审核时，实时推送通知给管理员
- 在页面顶部显示通知气泡
- 支持通知点击跳转到对应页面

### 4.6 权限管理系统

实现基于角色的访问控制（RBAC）。

**实现要点**:
- 创建角色表和权限表
- 为不同角色分配不同的菜单访问权限和操作权限
- 在前端根据权限动态显示/隐藏菜单和按钮
- 在后端API中进行权限校验

---

## 开发优先级建议

根据业务重要性和用户需求，建议按以下优先级开发：

**第一优先级（核心业务功能）**:
1. 开奖管理功能 - 这是夺宝业务的核心环节

**第二优先级（合规和风控）**:
2. KYC审核功能 - 满足合规要求，防范风险
3. 操作日志记录 - 审计和问题追溯

**第三优先级（运营效率提升）**:
4. 数据导出功能 - 提升运营效率
5. 批量操作功能 - 减少重复操作

**第四优先级（系统完善）**:
6. 系统设置模块 - 提升系统灵活性
7. 数据可视化增强 - 更好的数据洞察
8. 实时通知功能 - 提升响应速度

**第五优先级（高级功能）**:
9. 权限管理系统 - 适用于多管理员场景

---

## 技术债务和改进点

除了新功能开发，还有一些现有代码的改进点：

1. **错误处理增强**: 为所有API调用添加统一的错误处理和用户友好的错误提示
2. **加载状态优化**: 为所有异步操作添加骨架屏或加载动画
3. **表单验证增强**: 使用 `react-hook-form` 和 `zod` 进行统一的表单验证
4. **代码复用**: 抽取公共组件和工具函数，减少重复代码
5. **性能优化**: 实现虚拟滚动、懒加载等优化长列表性能
6. **单元测试**: 为关键业务逻辑添加单元测试
7. **API文档**: 使用OpenAPI/Swagger生成API文档

---

## 联系和反馈

如果你对这些功能有任何疑问或建议，欢迎反馈。
